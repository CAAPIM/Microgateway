# this lac node will have it's port exposed so that the cli process (simulating ci/cd)
# in the script will be able to deploy the api and modify it for consumption
version: '3'
services:
  # Start one node of lac with port exposed to host for admin/ui access
  # this node cannot be scaled because of exposed port
  lac-admin:
    image: caliveapicreator/4.0.00-demo
    build:
      context: .
    ports:
      - '8111:8080'
    environment:
      - RDS_HOSTNAME=lac_mysql
      - RDS_PORT=3306
      - RDS_USERNAME=lac_admin
      - RDS_PASSWORD=CAdemo123
      - RDS_DB_NAME=lac_admin
      - ca_accept_license=ENU

  # Start one node of LAC without port exposed that can be dynamically scaled
  lac-node:
    image: caliveapicreator/4.0.00-demo
    build:
      context: .
    environment:
      - RDS_HOSTNAME=lac_mysql
      - RDS_PORT=3306
      - RDS_USERNAME=lac_admin
      - RDS_PASSWORD=CAdemo123
      - RDS_DB_NAME=lac_admin
      - ca_accept_license=ENU
